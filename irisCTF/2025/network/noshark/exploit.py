from scapy.all import *

# 텍스트 파일에서 16진수 데이터 읽기
with open("noshark.txt", "r") as f:
    raw_data = f.read()

# 16진수 문자만 남기기
hex_data = ''.join(filter(lambda x: x in "0123456789abcdefABCDEF", raw_data))

# 홀수 길이 데이터 보완
if len(hex_data) % 2 != 0:
    hex_data += "0"

# 바이너리 데이터 변환
binary_data = bytes.fromhex(hex_data)

# 패킷 분석
packet = IP(binary_data)

# 페이로드 확인
if Raw in packet:
    payload = packet[Raw].load
    print("Payload (ASCII):")
    print(payload.decode('latin1', errors='replace'))  # ASCII로 변환
    print("\nSearching for 'Baby Shark' or 'irisCTF'...")

    # 키워드 검색
    if b'Baby Shark' in payload or b'irisCTF' in payload:
        print("Keyword found in payload!")
    else:
        print("No keyword found in payload.")
